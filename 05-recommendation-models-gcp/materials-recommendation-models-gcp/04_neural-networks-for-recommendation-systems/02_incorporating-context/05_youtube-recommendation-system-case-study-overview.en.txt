Previously in this course, we saw some examples of YouTube recommendations. As we can see from the image, most recommendations are along the same vein, because perhaps this user enjoys programming, TensorFlow, and machine learning. But it also has serendipitous recommendations such as the no sugar video which we may like despite never thinking to search for it. There is obviously a very sophisticated hybrid recommendation system under the hood of YouTube, because it typically makes great recommendations to its users. Let's now take a look underneath and see what exactly is going on. YouTube uses a pretty complex hybrid recommendation system that consists of two neural networks and many different data sources to make great video recommendations. There's a candidate generation network that accepts millions of video corpuses. The output of this network, which is in the hundreds, is the input to a ranking network combined with other candidate sources, which could be things like videos in the news for freshness, videos for neighboring videos,related videos, or sponsored videos. This is also combined with video features. This produces dozens of recommendations. Both networks also have user history and context feeding into them to improve the recommendation quality. But training this hybrid model is not as simple as just setting an out of the box loss function and letting it go. YouTube trains the candidate generation network to have high precision. High precision in this case means that every candidate generated is relevant to user. Obviously, this is important because users do not want to be shown irrelevant videos and will lose trust in the recommendations and product. However, the second ranking network trains to have high recall. High recall in this case means that it will recommend things the user will definitely like. Now that we've started to see what is under the hood of YouTube's hybrid recommendation system, let's test your knowledge. YouTube uses two neural networks connected in an ML pipeline. What metric is the candidate generation network trained to maximize? What metric is the ranking network trained to maximize? When thinking about which answer is correct, it may help to think about what each network is supposed to do, and what metric would help it do that. The correct answer is F, precision and recall. The candidate generation network is taking millions of video corpuses, as well as user and context history, to narrow down the field to hundreds of candidate videos. It wants to make sure that what it is predicting will be highly relevant to the user. Therefore, to ensure that, precision is a good choice. To make sure that when we say something is relevant, we can do it with high confidence. The ranking network is taking these hundreds of candidate videos, combining that with video features and other candidate sources, as well as user and context history. The function of the ranking network is to narrow down the candidates even further to only dozens, while making sure that the videos being returned will definitely be something that users like. This means that maximizing recall for this network will help make sure this happens. Therefore, users end up with relevant videos that they really like.